* Dotfiles

Single unified flake for NixOS + Home Manager across laptop, PC, and server.

** Docs

#+BEGIN_SRC
├── flake.nix                     # top-level flake for NixOS + HM (per-host nixpkgs)
├── home/
│   ├── config/                   # configs linked into $XDG_CONFIG_HOME
│   ├── hosts/
│   │   ├── international.nix     # HM per-host settings (laptop)
│   │   └── interplanetary.nix    # HM per-host settings (PC)
│   ├── modules/                  # HM modules: programs, editors, wms, etc
│   └── shared/                   # shared HM settings
├── nixos/
│   ├── hosts/
│   │   ├── international/        # NixOS host (laptop)
│   │   ├── interplanetary/       # NixOS host (PC)
│   │   └── cumserver/            # NixOS server (has extra modules)
│   └── modules/                  # reusable NixOS modules
└── packages/                     # custom derivations
#+END_SRC

Note: Some HM configs are linked via activation scripts for local editing without rebuilds. This makes HM not strictly pure and not intended for remote application.

** Install / Rebuild

1. Enable flakes
2. Setup secrets mentioned in =home/secrets.nix= and =nixos/hosts/shared/secrets.nix=
3. Switch NixOS (from repo root):
   - =sudo nixos-rebuild switch --flake .#interplanetary=
   - =sudo nixos-rebuild switch --flake .#international=
   - =sudo nixos-rebuild switch --flake .#cumserver=
4. Home Manager is managed via the NixOS module and rebuilt with the system. No separate HM flake or aliases.
5. Per-host nixpkgs pins can be updated independently:
   - =nix flake lock --update-input nixpkgs-interplanetary=
   - =nix flake lock --update-input nixpkgs-international=
   - =nix flake lock --update-input nixpkgs-cumserver=

** How to understand Nix?

- [[https://github.com/hlissner/dotfiles#frequently-asked-questions][Read links at the buttom]]
- [[https://www.youtube.com/watch?v=Eni9PPPPBpg][Listen to this]]
